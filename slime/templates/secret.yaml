{{- $root := . }}
{{- range $index, $value := .Values.secrets }}
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    {{- include "slime.labels" $root | nindent 4 }}
  {{- range $key, $val := $value.metadata }}
    {{- if eq $key "labels" }}
    {{- range $k, $v := $value.metadata.labels }}
    {{ $k }}: {{ $v }}
    {{- end }}
  {{- else }}
  {{- if regexMatch "^(string|bool|int|float64)$" (printf "%T" $val) }}
  {{ $key }}: {{ $val }}
  {{- else }}
  {{ $key }}:
    {{- toYaml $val | nindent 4 }}
  {{- end }}
  {{- end }}
  {{- end }}
{{- with $value.data }}
data:
{{- range $k, $v :=  $value.data }}
  {{ $k }}: {{ . | b64enc | quote }}
{{- end }}
{{- with $value.stringData }}
stringData:
  {{- . | toYaml | nindent 2 }}
{{- end }}
{{- with $value.type }}
type:
  {{- . | toYaml | nindent 2 }}
{{- end }}
{{- end }}
{{- end }}
